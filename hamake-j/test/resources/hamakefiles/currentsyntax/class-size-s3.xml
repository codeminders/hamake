<?xml version="1.0" encoding="UTF-8"?>

<project name="test">

	<property name="output" value="s3://hamake/test/" />
	<property name="lib" value="s3://hamake/lib/" />
	<property name="dist" value="s3://hamake/" />
	<property name="scripts" value="s3://hamake/" />

	<foreach name="jar-listings">
		<input>
			<fileset path="${lib}/" mask="*.jar" />
		</input>

		<output>
			<identity path="${output}/jar-listings" />
		</output>

		<mapreduce jar="${dist}/hamake-examples-1.0.jar" main="com.codeminders.hamake.examples.JarListing">
			<parameter value="${input}" />
			<parameter value="${output}" />
		</mapreduce>
	</foreach>

	<foreach name="filter-listing">
		<input>
			<fileset path="${output}/jar-listings" />
		</input>

		<output>
			<identity path="${output}/jar-listings-filtered" />
		</output>

		<mapreduce jar="${dist}/hamake-examples-1.0.jar" main="com.codeminders.hamake.examples.JarListingFilter">
			<parameter value="${input}" />
			<parameter value="${output}" />
		</mapreduce>
	</foreach>

	<fold name="histogram">

		<input>
			<file path="${output}/jar-listings-filtered" />
		</input>

		<output>
			<file path="${output}/class-size-histogram" />
		</output>

		<mapreduce jar="${dist}/hamake-examples-1.0.jar" main="com.codeminders.hamake.examples.ClassSizeHistogram">
			<parameter value="${input}" />
			<parameter value="${output}" />
		</mapreduce>

	</fold>

</project>